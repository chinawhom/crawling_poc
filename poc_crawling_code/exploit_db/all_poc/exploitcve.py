import urllib.request
from bs4 import BeautifulSoup
import time
import re
import time
import ssl
ssl._create_default_https_context = ssl._create_unverified_context
cnt=0
urlh="https://www.exploit-db.com/exploits/"
pocdic={}
#urlt="+poc&type=Repositories"
#numlist=['45005','37881']
fnum=open('C:/Users/sskk1/Desktop/exploitgit_num.txt','r')
f=open('C:/Users/sskk1/Desktop/exploitcve.txt','w')
e=open('C:/Users/sskk1/Desktop/exploitcveerror.txt','w')
numlist=fnum.readlines()
numlist=numlist
hdr = {'User-agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64)'}
for num in numlist:
	request=urllib.request.Request(urlh+num, headers=hdr)
	response=urllib.request.urlopen(request)
	html=response.read()
	soup=BeautifulSoup(html,'html.parser',from_encoding="utf-8")
	#print(soup)
	info=soup.find('div',{'class' : 'info'})
	#print(info)
	try:
		td=info.find_all('td')
		for t in td:
			#print(t)
			strong=t.find('strong')
			if 'CVE' in str(strong):
				a=t.find('a')
				#print(a)
				if a:				
					if 'java' in a.get('href'):
						data=a.get('data-content')
						data=BeautifulSoup(data,'html.parser')
						a=data.find_all('a')
						print(a)
						for cve in a:
							print(cve.text+"       "+num)
							f.write(cve.text+"              "+num)
							
					else:
						print(a.text+"       "+num)
						f.write(a.text+"              "+num)
					break
	except:
		e.write("[+]error :"+num+"\n")
	print("["+str(cnt)+"]")
	cnt+=1
	time.sleep(0.5)



f.close()

