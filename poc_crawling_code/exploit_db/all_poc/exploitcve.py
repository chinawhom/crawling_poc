#고유번호로부터 cve알아내기.
import urllib.request
from bs4 import BeautifulSoup
import time
num=0
urlh="https://www.exploit-db.com/exploits/"
pocdic={}
#urlt="+poc&type=Repositories"
#numlist=['45005','37881']
fnum=open('C:/Users/bibi/Desktop/exploitgit_num.txt','r')
f=open('C:/Users/bibi/Desktop/exploitcve.txt','w')
numlist=fnum.readlines()
hdr = {'User-agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64)'}
for num in numlist:
	request=urllib.request.Request(urlh+num, headers=hdr)
	response=urllib.request.urlopen(request)
	html=response.read()
	soup=BeautifulSoup(html,'html.parser')
	info=soup.find('div',{'class' : 'info'})
	#print(info)
	td=info.find_all('td')
	for t in td:
		#print(t)
		strong=t.find('strong')
		if 'CVE' in str(strong):
			a=t.find('a')
			if 'java' in a.get('href'):
				data=a.get('data-content')
				data=BeautifulSoup(data,'html.parser')
				a=data.find_all('a')
				#print(a)
				for cve in a:
					f.write(cve.text+"              "+num)
					
			else:
				f.write(a.text+"              "+num)



f.close()

