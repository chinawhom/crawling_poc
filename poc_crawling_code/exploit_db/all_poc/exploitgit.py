#exploit-db의 cve, poc정보들 있는 git긁어오기 고유번호와 링크 긁어오기.
import urllib.request
from bs4 import BeautifulSoup
import re

url="https://github.com/offensive-security/exploit-database"

f=open('C:/Users/bibi/Desktop/exploitgit.txt','w')
#nf=open('C:/Users/bibi/Desktop/derrekrnopoclist.txt','w')
#gitpoc=open('C:/Users/bibi/Desktop/derrekrpoclist.txt',"w")
#velist=f.readlines()
pocdic={}

def makedic(a):
	global pocdic
	p=re.compile('[0-9]+[.][a-z]+')
	title=p.findall(a.get('title'))
	if title:
		for t in title:
			pocdic[t]=a.get('href')


def findpoc(url):
	request=urllib.request.urlopen(url)
	html=request.read()
	soup=BeautifulSoup(html,'html.parser')
	content=soup.find_all('td',{'class':'content'})
	print("[+]find poc on "+url)
	for c in content:
		a=c.find('a')
		if(a):
			if '.' not in a.get('title'):
				findpoc("https://github.com"+a.get('href'))
			else:
				makedic(a)

findpoc(url)

find=0
for p in pocdic:
	f.write(p+"     "+pocdic[p]+"\n")

#for cve in cvelist:
#	print("[+]"+cve)
#	if cve[:-1] in pocdic:
#		gitpoc.write(pocdic[cve[:-1]]+'    ')
#		gitpoc.write(cve)
#		find+=1
#	else:
#		nf.write(cve)
#		a=1

#print('find # : ',end="")
#print(find)

f.close()
#nf.close()
#gitpoc.close()

